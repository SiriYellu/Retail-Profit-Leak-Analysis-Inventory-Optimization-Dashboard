flowchart LR
    U[Stakeholders / Users] -->|Interact| BI[Power BI / Tableau Dashboards]
    U -->|Download| XL[Excel What-If Model]

    subgraph DATA[Data Sources]
        S1[Orders CSV]
        S2[Order Items CSV]
        S3[Products CSV]
        S4[Stores CSV]
        S5[Inventory CSV]
        S6[Returns CSV]
        S7[Promotions CSV]
    end

    DATA --> ETL[ETL and Load Scripts]
    ETL --> DB[(SQL Database: PostgreSQL or SQL Server)]

    subgraph SQL_LAYER[SQL Analytics Layer]
        STG[Staging Tables]
        DWH[Star Schema: Fact and Dimensions]
        VIEWS[Analytics Views: KPIs and Aggregations]
    end

    DB --> STG --> DWH --> VIEWS
    VIEWS --> BI
    VIEWS --> XL

    BI --> OUT1[Insights: Profit leaks, returns, discounts, stockouts]
    XL --> OUT2[Scenarios: Discount changes and margin impact]
